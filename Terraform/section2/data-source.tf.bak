# Data source from other provide's data source
/*
terraform {
  required_providers {
    digitalocean = {
      source = "digitalocean/digitalocean"
    }
  }
}

provider "digitalocean" {
  token = "token"
}
*/

# Data source from local file
data "local_file" "foo" {
  # ${path.module} represents path of current .tf
  filename = "${path.module}/local_file.txt"
}

output "data" {
  value = data.local_file.foo.content
}


# Data source from AWS

# This method fetchs multiple ec2 instances form specified region
provider "aws" {
  region = "ap-southeast-2"
}

data "aws_instances" "example_instances" {}

# This method fetchs single ec2 instance through "filter"
data "aws_instance" "example_instance" {
  filter {
    name   = "tag:Team"
    values = ["Production"]
  }
}

# Fetch AMI data source 
data "aws_ami" "myimage" {
  most_recent = true
  owners      = ["amazon"]

  filter {
    name   = "name"
    values = ["ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*"]
  }
}

resource "aws_instance" "web" {
  ami           = data.aws_ami.myimage.image_id
  instance_type = "t2.micro"
}
